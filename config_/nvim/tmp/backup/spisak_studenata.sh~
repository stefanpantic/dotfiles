#! /bin/sh
#  __________________________
# < Hi, sed and grep are cool>
#  --------------------------
#         \   ^__^
#          \  (oo)\_______
#             (__)\       )\/\
#                 ||----w |
#                 ||     ||
#  --------------------------
# ZADATAK:
# U datotekama nastava.html i nastava1.html nalaze se podaci
#  studenatima I smera.
# Koristeci alate komandne linije grep, sed i sort
# izlistati studente u obliku:
# 1. Ime1, Prezime1, mi12123
# 2. Ime2, Prezime2, mi12124
# ...
# n. ImeN, PrezimeN, mi12124
# Pri cemu su studenti sortirani leksikografski neopadajuće po imenu.


####################################################
# #####  ######  ####  ###### #    #      # ###### #
# #    # #      #      #      ##   #      # #      #
# #    # #####   ####  #####  # #  #      # #####  #
# #####  #           # #      #  # #      # #      #
# #   #  #      #    # #      #   ## #    # #      #
# #    # ######  ####  ###### #    #  ####  ###### #
####################################################
# Pokretanje: ./spisak_studenata.sh
# (datoteka mora biti izvršiva:
# chmod +x spisak_studenata.sh
# NAPOMENA: Ukoliko pipe (simbol |) stavljate u novi red nakon naredbe,
# morate staviti \ u tekucoj liniji, inace bice prijavljena greska pri izvrsavanju.
# Na primer:
# ls
# | wc -l
# Prijavljuje gresku jer | nije u prvoj liniji.
# Ukoliko zelimo | da bude kao u navedenom primeru onda>
# ls \
# | wc -l

# mozemo nekada rezultate izvuci i jednostavnim regex-om
#egrep -h '<td>[a-zA-Z]' nastava.html nastava1.html |
# no bolje je biti precizan jer u buducnosti mozda budu postojali nevalidni podaci
egrep '<td>\s*[a-zA-Z]+\s*[a-zA-Z]+</td><td>\s*[0-9]{1,3}/[0-9]{4}</td>' nastava*.html -h |
 #brisemo vodece beline
sed 's/\s*//' |
# menjamo ime i prezime
sed -r 's/<td>([a-zA-Z]+)\s*([a-zA-Z]+)<\/td>/\2 \1/' |
# <td> -> ,
sed -r 's/<td>/, /' |
# na jednocifrene brojeve indeksa dodajemo vodece nule
sed -r 's/ ([0-9])\//00\1\//' |
# slicno, na dvocifrene brojeve dodajemo vodecu nulu
sed -r 's/ ([0-9]{2})\// 0\1\//' |
# konstruisemo indeks oblika mixxyyy
sed -r 's/([0-9]{1,3})\/[0-9]{2}([0-9]{2}).*/mi\2\1/' |
# sortiramo leksikografski sadrzaj
sort |
# umecemo redne brojeve koristeci grep (primetimo da regex .* prihvata sve linije)
grep -n '.*' |
# menjamo : sa . i dodajemo razmak
sed 's/:/. /'



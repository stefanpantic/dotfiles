#!/bin/sh

# Zadatak:
# Izvuci ime, prezime i broj indeksa svakog studenta koji ima nalog na alasu
# cije ime je dobro postavljeno, tj. nije jednako broju indeksa.
# Sortitati ih i numerisati i potom ispisati u formatu 'Broj: Ime/Prezime Indeks/Godina'

# Uputstvo za alas:
# scp ime_fajla mi12345@alas.matf.bg.ac.rs:ime_fajla - za prenos fajla na alas
# scp mi12345@alas.matf.bg.ac.rs:ime_fajla ime_fajla - za prenos fajla sa alasa
# ssh mi12345@alas.matf.bg.ac.rs i zatim ukucati sifru na prompt

# Pokretanje:
# ./alas_list.sh
# imati strpljenja, treba mu malo vise vremena da izvrsi

# pokupi nazive svih direktorijuma u /home
ls /home |
# izvuci samo one unose koji odgovaraju formatu indeksa
grep -Eo '(a(i|f)|m(i|r|m|n|v))[0-9]{5}' |
# prosledjujemo jedan po jedan brojeve indeksa u komandu finger (man finger za info)
xargs -n 1 finger 2>/dev/null|
# ovde cemo uhvatiti liniju u kojoj se nalazi broj indeksa i ime, ali cemo istovremeno odbaciti one unose gde
# su ime i broj indeksa isti
grep -P 'Login: (a(i|f)|m(i|r|m|n|v)[0-9]{5})\s*Name: (?!\1)' |
# oblik 'Login: mr12345 	Name: Pera Peric' prebacujemo u oblik 'Pera Peric 345/12'
sed -r 's/Login: (a(i|f)|m(i|r|m|n|v)([0-9]{2})([0-9]{3}))\s*Name: (.*?)/  \6 \5\/\4/' |
# sortiramo
sort |
# numerisemo
grep -n .
